#:import MapView kivy.garden.mapview.MapView
#import GpsBlinker gpsblinker.GpsBlinker
#include gpsblinker.kv

<ItemDrawer>:
    on_release: 
        self.parent.set_color_item(self)
        app.root.windows.current = self.text
    
    IconLeftWidget:
        id: icon
        icon: root.icon
        
<ContentNavigationDrawer>:
    orientation: "vertical"
    padding: "8dp"
    spacing: "8dp"
    

    AnchorLayout:
        anchor_x: "left"
        size_hint_y: None
        height: avatar.height

        Image:
            id: avatar
            size_hint: None, None
            size: "56dp", "56dp"
            source: "data/logo/kivy-icon-256.png"

    MDLabel:
        text: "Settings"
        font_style: "Button"
        size_hint_y: None
        height: self.texture_size[1]
        theme_text_color: "Secondary"
       

    MDLabel:
        text: "triproulette@gmail.com"
        font_style: "Caption"
        size_hint_y: None
        height: self.texture_size[1]
        theme_text_color: "Secondary"
        
    ScrollView:

        DrawerList:
            id: md_list

    # MDToolbar:
    #     title: "Navigation Drawer"
    #     elevation: 10
    #     left_action_items: [['menu', lambda x: nav_drawer.toggle_nav_drawer()]]

<MapView>:
    zoom: 2
    # GpsBlinker:
    #     id: blinker
    #     lat: root.lat
    #     lon: root.lon

<Form>
    name: "Form"
    FloatLayout:

        MDIconButton:
            icon: "settings"
            pos_hint: {"top": 0.95, "x": 0.05}
            height: self.width
            on_release: app.root.nav_drawer.toggle_nav_drawer()
            md_bg_color: app.theme_cls.primary_color

MainScreen:
    nav_drawer: nav_drawer
    windows: windows
    NavigationLayout:
        id: nav_layout
    
        WindowManager:
            id: windows

            HomePage:
                id: homepage

            Form:

        MDNavigationDrawer:
            id: nav_drawer

            ContentNavigationDrawer:
                id: content_drawer

<HomePage>:
    name: "HomePage"
    map: mapview
    MapView:
        id: mapview

    FloatLayout:

        MDIconButton:
            icon: "settings"
            pos_hint: {"top": 0.95, "x": 0.05}
            height: self.width
            on_release: app.root.nav_drawer.toggle_nav_drawer()
            md_bg_color: app.theme_cls.primary_color
        
        MDRaisedButton:
            text: "Generate Trip"
            md_bg_color: app.theme_cls.primary_dark
            pos_hint: {"center_x": 0.5, "y": 0.03}
            size_hint: 0.8, 0.1

        MDRoundFlatButton:
            text: "Log In"
            text_color: app.theme_cls.primary_color
            pos_hint: {"center_x": 0.25, "y": 0.15}
            size: account_create.size

        MDRoundFlatButton:
            id: account_create
            text: "Create Account"
            text_color: app.theme_cls.primary_color
            pos_hint: {"center_x": 0.75, "y": 0.15}
            
        MDIconButton:
            icon: "crosshairs-gps"
            pos_hint: {"y": 0.25, "right": 0.9}
            height: self.width
            md_bg_color: app.theme_cls.primary_color
            
        MDFloatingActionButtonSpeedDial:
            data: app.data
            rotation_root_button: True
            md_bg_color: app.theme_cls.primary_color  
            hint_animation:  True
            callback: app.toast_pop